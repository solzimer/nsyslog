{
  "config": {
    "datadir": "/tmp/nsyslog",
    "collector" : {
      "enabled" : false
    },
    "frontend": {
      "host": "0.0.0.0",
      "port": 19998,
      "context": "/",
      "ssl": {
        "enabled": false,
        "key": "./monitor.key",
        "cert": "./monitor.crt"
      }
    },
    "input": {
      "buffer": 100
    }
  },
  "register": [
    {
      "type": "processor",
      "id": "leak",
      "require": "../custom/custom-processor-leak.js"
    }
  ],
  "inputs": {
    "lines_dst1": {
      "type": "static",
      "attach": [
        "flow1"
      ],
      "config": {
        "loop": true,
        "interval": 100,
        "lines": [
          {"url":"ws://localhost:6540/logs", "host":"APP1", "message": "<188>0 2025-11-13T01:03:54+01:00 172.26.200.6 APP1(root) - - -  46809403 Threat@FLOW: From 45.227.254.30:59674(aggregate1.21) to 79.170.8.238:135(-), threat name: Blacklist-IP, threat type: Attack, threat subtype: Risk IP, App/Protocol: IPv4/TCP, action: DROP, defender: PTF, severity: Low, detected low reputation ip: 45.227.254.30, category: Scanner, reputation score 100, hit-count: 1(in the last 5 seconds)"},
          {"url":"ws://localhost:6550/logs", "host":"APP2", "message": "<188>0 2025-11-13T01:03:56+01:00 172.26.200.6 APP2(root) - - -  46809403 Threat@FLOW: From 185.173.35.41:63867(aggregate1.21) to 79.170.8.139:1521(-), threat name: Blacklist-IP, threat type: Attack, threat subtype: Risk IP, App/Protocol: IPv4/TCP, action: DROP, defender: PTF, severity: Low, detected low reputation ip: 185.173.35.41, category: Scanner, reputation score 68, hit-count: 1(in the last 5 seconds)"}
        ]
      }
    }
  },
  "processors": {
  },
  "transporters": {
    "websocket" : {
      "type": "websocket",
      "config": {
        "url": "${originalMessage.url}",
        "format": "${originalMessage}",
        "reconnect": {
          "enabled": true,
          "maxRetries": 10,
          "delay": 5000
        }
      }
    },
    "console": {
      "type": "console",
      "attach": [
        "flow1"
      ],
      "config": {
        "format": "${JSON:2}",
        "json": {
          "format": true,
          "spaces": 2,
          "color": true
        }
      }
    },
    "null": {
      "type": "null"
    }
  },
  "flows": [
    {
      "id": "flow1",
      "from": "lines_dst1",
      "fork": false,
      "processors": [],
      "transporters": "websocket"
    }
  ]
}